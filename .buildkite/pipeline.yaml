steps:
  - label: ':docker: Build image'
    command: .buildkite/bin/build

  - type: waiter
    if: build.env("SCHEDULED_UPDATE") == "true"

  - label: Notify Slack
    command: .buildkite/bin/slack-notify
    if: build.env("SCHEDULED_UPDATE") == "true"

  - type: waiter
    branches: master

  - label: ':docker: Build image awscli'
    command: .buildkite/bin/build
    env:
      IMAGE_VARIANT: awscli

  - type: block
    branches: master

  - label: ':docker: Tag latest'
    command: .buildkite/bin/release
    branches: master